<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Dashboard - ShipCruiseTour</title>
    <link rel="stylesheet" href="dashboard-styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="dashboard-header">
        <div class="container">
            <div class="header-content">
                <h1><i class="fas fa-chart-line"></i> Test Dashboard</h1>
                <div class="header-meta">
                    <span class="project-name">ShipCruiseTour QA</span>
                    <span class="test-date" id="testDate">Loading...</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Scope Tabs -->
    <section class="scope-tabs-section">
        <div class="container">
            <div class="scope-tabs" role="tablist">
                <button class="scope-tab active" data-scope="all" role="tab" aria-selected="true">
                    <i class="fas fa-layer-group"></i>
                    All
                    <span class="scope-count" id="scopeAllCount">0</span>
                </button>
                <button class="scope-tab" data-scope="frontend" role="tab" aria-selected="false">
                    <i class="fas fa-desktop"></i>
                    Frontend
                    <span class="scope-count" id="scopeFrontendCount">0</span>
                </button>
                <button class="scope-tab" data-scope="backend" role="tab" aria-selected="false">
                    <i class="fas fa-database"></i>
                    Backend
                    <span class="scope-count" id="scopeBackendCount">0</span>
                </button>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <main class="dashboard-main">
        <div class="container">
            <section class="kpi-section">
                <h2 class="section-title">Key Metrics</h2>
                <div class="kpi-grid">
                    <div class="kpi-card kpi-total">
                        <div class="kpi-icon">
                            <i class="fas fa-vial"></i>
                        </div>
                        <div class="kpi-content">
                            <div class="kpi-value" id="totalTests">0</div>
                            <div class="kpi-label">Total Tests</div>
                        </div>
                    </div>
                    <div class="kpi-card kpi-passed">
                        <div class="kpi-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="kpi-content">
                            <div class="kpi-value" id="passedTests">0</div>
                            <div class="kpi-label">Passed</div>
                            <div class="kpi-percentage" id="passedPercentage">0%</div>
                        </div>
                    </div>
                    <div class="kpi-card kpi-failed">
                        <div class="kpi-icon">
                            <i class="fas fa-times-circle"></i>
                        </div>
                        <div class="kpi-content">
                            <div class="kpi-value" id="failedTests">0</div>
                            <div class="kpi-label">Failed</div>
                            <div class="kpi-percentage" id="failedPercentage">0%</div>
                        </div>
                    </div>
                    <div class="kpi-card kpi-skipped">
                        <div class="kpi-icon">
                            <i class="fas fa-forward"></i>
                        </div>
                        <div class="kpi-content">
                            <div class="kpi-value" id="skippedTests">0</div>
                            <div class="kpi-label">Skipped</div>
                            <div class="kpi-percentage" id="skippedPercentage">0%</div>
                        </div>
                    </div>
                    <div class="kpi-card kpi-rate">
                        <div class="kpi-icon">
                            <i class="fas fa-percentage"></i>
                        </div>
                        <div class="kpi-content">
                            <div class="kpi-value" id="passRate">0%</div>
                            <div class="kpi-label">Pass Rate</div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="passRateBar"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Duration Card -->
                    <div class="kpi-card kpi-duration">
                        <div class="kpi-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="kpi-content">
                            <div class="kpi-value" id="totalDuration">0s</div>
                            <div class="kpi-label">Total Duration</div>
                            <div class="kpi-percentage" id="avgDuration">Avg: 0s</div>
                        </div>
                    </div>
                    <div class="kpi-card kpi-category kpi-frontend">
                        <div class="kpi-category-header">
                            <div class="kpi-icon">
                                <i class="fas fa-desktop"></i>
                            </div>
                            <div>
                                <div class="kpi-label">Frontend Tests</div>
                                <div class="kpi-value" id="frontendTotal">0</div>
                            </div>
                        </div>
                        <div class="kpi-category-breakdown">
                            <div>
                                <span class="label">Passed</span>
                                <strong id="frontendPassed">0</strong>
                            </div>
                            <div>
                                <span class="label">Failed</span>
                                <strong id="frontendFailed">0</strong>
                            </div>
                        </div>
                        <div class="progress-bar small">
                            <div class="progress-fill" id="frontendPassRateBar"></div>
                        </div>
                        <div class="kpi-percentage" id="frontendPassRate">Pass Rate: 0%</div>
                    </div>
                    <div class="kpi-card kpi-category kpi-backend">
                        <div class="kpi-category-header">
                            <div class="kpi-icon">
                                <i class="fas fa-database"></i>
                            </div>
                            <div>
                                <div class="kpi-label">Backend Tests</div>
                                <div class="kpi-value" id="backendTotal">0</div>
                            </div>
                        </div>
                        <div class="kpi-category-breakdown">
                            <div>
                                <span class="label">Passed</span>
                                <strong id="backendPassed">0</strong>
                            </div>
                            <div>
                                <span class="label">Failed</span>
                                <strong id="backendFailed">0</strong>
                            </div>
                        </div>
                        <div class="progress-bar small">
                            <div class="progress-fill" id="backendPassRateBar"></div>
                        </div>
                        <div class="kpi-percentage" id="backendPassRate">Pass Rate: 0%</div>
                    </div>
                </div>
            </section>

            <!-- Category Breakdown -->
            <section class="category-section">
                <h2 class="section-title">Suite Breakdown</h2>
                <div class="category-grid" id="categoryCards">
                    <!-- Category cards injected via reporter.js -->
                </div>
            </section>

            <!-- Charts Section -->
            <section class="charts-section">
                <h2 class="section-title">Visualizations</h2>
                <div class="charts-grid">
                    <!-- Status Distribution Chart -->
                    <div class="chart-card">
                        <h3 class="chart-title">Test Status Distribution</h3>
                        <div class="chart-container">
                            <canvas id="statusChart"></canvas>
                        </div>
                    </div>

                    <!-- Suite Results Chart -->
                    <div class="chart-card">
                        <h3 class="chart-title">Results by Test Suite</h3>
                        <div class="chart-container">
                            <canvas id="suiteChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Test Results Section -->
            <section class="results-section">
                <div class="results-header">
                    <h2 class="section-title">Test Results</h2>
                    <div class="results-actions">
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" id="searchInput" placeholder="Search tests...">
                        </div>
                        <div class="filter-group">
                            <button class="filter-btn active" data-filter="all">
                                All <span class="badge" id="filterAllCount">0</span>
                            </button>
                            <button class="filter-btn" data-filter="passed">
                                Passed <span class="badge badge-passed" id="filterPassedCount">0</span>
                            </button>
                            <button class="filter-btn" data-filter="failed">
                                Failed <span class="badge badge-failed" id="filterFailedCount">0</span>
                            </button>
                            <button class="filter-btn" data-filter="skipped">
                                Skipped <span class="badge badge-skipped" id="filterSkippedCount">0</span>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="results-table-container">
                    <table class="results-table">
                        <thead>
                            <tr>
                                <th class="sortable" data-sort="name">
                                    Test Name <i class="fas fa-sort"></i>
                                </th>
                                <th class="sortable" data-sort="suite">
                                    Suite <i class="fas fa-sort"></i>
                                </th>
                                <th class="sortable" data-sort="status">
                                    Status <i class="fas fa-sort"></i>
                                </th>
                                <th class="sortable" data-sort="duration">
                                    Duration <i class="fas fa-sort"></i>
                                </th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="resultsTableBody">
                            <!-- Table rows will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>

                <div class="no-results" id="noResults" style="display: none;">
                    <i class="fas fa-search"></i>
                    <p>No tests found matching your criteria.</p>
                </div>
            </section>

            <!-- Footer -->
            <footer class="dashboard-footer">
                <div class="footer-links">
                    <a href="../playwright-report/index.html" class="footer-link">
                        <i class="fas fa-file-alt"></i> View Full Playwright Report
                    </a>
                    <a href="#" class="footer-link" onclick="window.print(); return false;">
                        <i class="fas fa-print"></i> Print Report
                    </a>
                </div>
                <div class="footer-info">
                    <p>Generated by Custom Playwright Dashboard Reporter</p>
                </div>
            </footer>
        </div>
    </main>

    <!-- Test Detail Modal -->
    <div class="modal" id="testModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Test Details</h3>
                <button class="modal-close" onclick="closeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- Modal content will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Artifact Viewer Modal -->
    <div class="modal" id="artifactModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 id="artifactModalTitle">Artifact Viewer</h3>
                <button class="modal-close" onclick="closeArtifactModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="artifactModalBody">
                <!-- Artifact content will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="data-parser.js"></script>
    <script src="reporter.js"></script>
</body>
</html>
